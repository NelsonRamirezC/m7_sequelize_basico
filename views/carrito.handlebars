<h1 class="text-center mt-5">PÃ¡gina de carrito</h1>


<table class="table mt-5">
  <thead>
    <tr>
      <th scope="col">ID</th>
      <th scope="col">Nombre</th>
      <th scope="col">Precio</th>
      <th scope="col">Cantidad</th>
      <th scope="col">total</th>
   {{!--    <th scope="col">resta</th> --}}

    </tr>
  </thead>
  <tbody>
    {{#each carrito}}
        <tr>
            <td>{{this.id}}</td>
            <td>{{this.nombre}}</td>
            <td>{{this.precio}}</td>
            <td><button onclick="restar({{this.id}})">-</button> {{this.cantidad}} <button onclick="sumar({{this.id}})">+</button></td>
            <td>{{this.total}}</td>
          {{!--   <td>{{resta this.cantidad this.cantidad}}</td> --}}
        </tr>
    {{/each}}
    <tr>
      <td colspan="5" class="text-center">Total a pagar: <strong>{{total}}</strong></td>
    </tr>
  </tbody>
</table>


<script>
    const restar = (id) => {

        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
        "id_producto": id
        });

        var requestOptions = {
        method: 'DELETE',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
        };

        fetch("/api/v1/carritos", requestOptions)
        .then(response => response.json())
        .then(result =>{
            alert(result.message);
            location.reload();
        })
        .catch(error => {
            alert(error)
        });

    }

    const sumar = (id) => {
        var myHeaders = new Headers();
        myHeaders.append("Content-Type", "application/json");

        var raw = JSON.stringify({
        "id_producto": id
        });

        var requestOptions = {
        method: 'POST',
        headers: myHeaders,
        body: raw,
        redirect: 'follow'
        };

        fetch("/api/v1/carritos", requestOptions)
        .then(response => response.json())
        .then(result =>{
            alert(result.message);
            location.reload();
        })
        .catch(error => {
            alert(error)
        });
    }
</script>

